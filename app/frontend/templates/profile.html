<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - MoirAI</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/profile.css">
    <link rel="stylesheet" href="/static/css/notifications.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Navbar - Generado din√°micamente por navbar-manager.js -->
    <nav class="navbar" id="navbar-container">
        <!-- Contenido insertado por JavaScript -->
    </nav>

    <!-- Main Content -->
    <main class="profile-main">
        <!-- Profile Header -->
        <section class="profile-header">
            <h1><i class="fas fa-user-circle"></i> Mi Perfil</h1>
            <p>Administra tu informaci√≥n personal y habilidades</p>
        </section>

        <!-- Profile Container -->
        <div class="profile-container">
            <div class="profile-content">
                <!-- Main Content -->
                <div class="profile-main-content" style="display: flex; flex-direction: column; gap: 1.5rem;">
                    
                    <!-- ‚ú® PRIORIDAD 1: Harvard CV Builder -->
                    <div id="harvard-cv-container" style="display: none; flex-direction: column; gap: 1.5rem;">
                        
                        <!-- Section 1: Professional Objective -->
                        <div class="profile-card cv-section-card">
                            <div class="cv-section-header-styled">
                                <div class="cv-header-icon">
                                    <i class="fas fa-bullseye"></i>
                                </div>
                                <div>
                                    <h3>Objetivo Profesional</h3>
                                    <p class="cv-section-subtitle">Tu declaraci√≥n profesional</p>
                                </div>
                            </div>
                            <div class="cv-section-content">
                                <div class="form-group">
                                    <textarea id="objective" name="objective" maxlength="500" placeholder="Tu objetivo profesional..." class="cv-textarea"></textarea>
                                    <small style="color: var(--text-secondary);">M√°ximo 500 caracteres</small>
                                </div>
                                <button type="button" class="btn btn-primary btn-sm" onclick="saveObjective()" style="align-self: flex-end; margin-top: 0.75rem;">
                                    <i class="fas fa-save"></i> Guardar
                                </button>
                            </div>
                        </div>

                        <!-- Section 2: Education -->
                        <div class="profile-card cv-section-card">
                            <div class="cv-section-header-styled">
                                <div class="cv-header-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div>
                                    <h3>Educaci√≥n</h3>
                                    <p class="cv-section-subtitle">Tu formaci√≥n acad√©mica</p>
                                </div>
                            </div>
                            <div class="cv-section-content">
                                <div id="education-list" class="cv-items-container">
                                    <!-- Items din√°micos -->
                                </div>
                                <button type="button" class="btn-add-item" onclick="addNestedItem('education', ['institution', 'degree', 'field_of_study', 'graduation_year'])">
                                    <i class="fas fa-plus"></i> Agregar Instituci√≥n
                                </button>
                            </div>
                        </div>

                        <!-- Section 3: Experience -->
                        <div class="profile-card cv-section-card">
                            <div class="cv-section-header-styled">
                                <div class="cv-header-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                    <i class="fas fa-briefcase"></i>
                                </div>
                                <div>
                                    <h3>Experiencia Profesional</h3>
                                    <p class="cv-section-subtitle">Tu trayectoria laboral</p>
                                </div>
                            </div>
                            <div class="cv-section-content">
                                <div id="experience-list" class="cv-items-container">
                                    <!-- Items din√°micos -->
                                </div>
                                <button type="button" class="btn-add-item" onclick="addNestedItem('experience', ['position', 'company', 'start_date', 'end_date', 'description'])">
                                    <i class="fas fa-plus"></i> Agregar Experiencia
                                </button>
                            </div>
                        </div>

                        <!-- Section 4: Skills -->
                        <div class="profile-card cv-section-card">
                            <div class="cv-section-header-styled">
                                <div class="cv-header-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                    <i class="fas fa-code"></i>
                                </div>
                                <div>
                                    <h3>Habilidades</h3>
                                    <p class="cv-section-subtitle">T√©cnicas & Blandas</p>
                                </div>
                            </div>
                            <div class="cv-section-content">
                                <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 1rem;">
                                    <i class="fas fa-info-circle"></i> Detectadas autom√°ticamente de tu CV
                                </p>
                                <div id="inferred-skills" class="cv-skills-grid">
                                    <div class="empty-state" style="text-align: center; padding: 2rem;">
                                        <i class="fas fa-brain"></i>
                                        <p>Sube tu CV para analizar</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 5: Certifications -->
                        <div class="profile-card cv-section-card">
                            <div class="cv-section-header-styled">
                                <div class="cv-header-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                    <i class="fas fa-award"></i>
                                </div>
                                <div>
                                    <h3>Certificaciones</h3>
                                    <p class="cv-section-subtitle">Acreditaciones profesionales</p>
                                </div>
                            </div>
                            <div class="cv-section-content">
                                <div id="certifications-list" class="cv-items-container cv-simple-list">
                                    <!-- Items din√°micos -->
                                </div>
                                <button type="button" class="btn-add-item" onclick="addSimpleItem('certifications')">
                                    <i class="fas fa-plus"></i> Agregar Certificaci√≥n
                                </button>
                            </div>
                        </div>

                        <!-- Section 6: Languages -->
                        <div class="profile-card cv-section-card">
                            <div class="cv-section-header-styled">
                                <div class="cv-header-icon" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <div>
                                    <h3>Idiomas</h3>
                                    <p class="cv-section-subtitle">Competencias ling√º√≠sticas</p>
                                </div>
                            </div>
                            <div class="cv-section-content">
                                <div id="languages-list" class="cv-items-container cv-simple-list">
                                    <!-- Items din√°micos -->
                                </div>
                                <button type="button" class="btn-add-item" onclick="addSimpleItem('languages')">
                                    <i class="fas fa-plus"></i> Agregar Idioma
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ‚ú® PRIORIDAD 2: Skills Card (Fallback) -->
                    <div class="profile-card" id="skills-card-fallback" style="display: none;">
                        <h2>
                            <i class="fas fa-brain"></i>
                            Habilidades Inferidas
                        </h2>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Estas habilidades fueron identificadas autom√°ticamente al procesar tu CV.
                        </p>
                        <div id="inferred-skills-fallback"></div>
                    </div>

                    <!-- Separator -->
                    <div style="border-top: 2px solid var(--border-color); margin: 0; opacity: 0.5;"></div>

                    <!-- ‚ú® PRIORIDAD 3: Security & Danger Zone -->
                    <div class="profile-card">
                        <h2><i class="fas fa-lock"></i> Seguridad</h2>
                        <button type="button" class="btn btn-secondary" onclick="handlePasswordChange()">
                            <i class="fas fa-key"></i> Cambiar Contrase√±a
                        </button>
                    </div>

                    <div class="danger-zone">
                        <h3><i class="fas fa-exclamation-triangle"></i> Zona de Peligro</h3>
                        <p>Eliminar tu cuenta es permanente y no se puede deshacer.</p>
                        <button type="button" class="btn" style="background: #ef4444; color: white;">
                            <i class="fas fa-trash"></i> Eliminar Cuenta
                        </button>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="profile-sidebar" style="display: flex; flex-direction: column; gap: 1.5rem;">
                    <!-- User Summary Card -->
                    <div class="profile-card" style="text-align: center;">
                        <div style="width: 100px; height: 100px; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); border-radius: 50%; margin: 0 auto 1rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3 id="sidebar-name">Usuario</h3>
                        <p style="color: var(--text-secondary); margin: 0 0 1rem 0;" id="sidebar-role">Estudiante</p>
                        <button type="button" class="btn btn-primary" style="width: 100%; justify-content: center;">
                            <i class="fas fa-camera"></i> Cambiar Foto
                        </button>
                    </div>

                    <!-- Informaci√≥n Personal Card -->
                    <div class="profile-card">
                        <h3 style="margin-top: 0; color: var(--primary-color);">
                            <i class="fas fa-id-card"></i>
                            Informaci√≥n Personal
                        </h3>
                        <form id="profile-form" class="profile-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="first_name">Nombre <span class="required">*</span></label>
                                    <input type="text" id="first_name" name="first_name" placeholder="Tu nombre" required>
                                </div>
                                <div class="form-group">
                                    <label for="last_name">Apellido <span class="required">*</span></label>
                                    <input type="text" id="last_name" name="last_name" placeholder="Tu apellido" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="email">Correo Electr√≥nico (no editable)</label>
                                <input type="email" id="email" name="email" disabled>
                            </div>
                            <div class="form-group">
                                <label for="phone">Tel√©fono</label>
                                <input type="tel" id="phone" name="phone" placeholder="+56 9 1234 5678">
                            </div>
                            <div class="form-group">
                                <label for="bio">Biograf√≠a <span class="required">*</span></label>
                                <textarea id="bio" name="bio" placeholder="Cu√©ntanos sobre ti..." required></textarea>
                            </div>

                            <!-- Student Fields -->
                            <div id="student-fields" style="display:none;">
                                <h3 style="margin-top: 0; color: var(--primary-color);">Informaci√≥n Acad√©mica</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="career">Carrera</label>
                                        <select id="career" name="career">
                                            <option value="">Selecciona tu carrera</option>
                                            <option value="Licenciatura en Ciencia de Datos para Negocios">Licenciatura en Ciencia de Datos para Negocios</option>
                                            <option value="Control y Automatizaci√≥n">Control y Automatizaci√≥n</option>
                                            <option value="administracion">Administraci√≥n</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="semester">Semestre</label>
                                        <select id="semester" name="semester">
                                            <option value="">Selecciona tu semestre</option>
                                            <option value="1">1er Semestre</option>
                                            <option value="2">2do Semestre</option>
                                            <option value="3">3er Semestre</option>
                                            <option value="4">4to Semestre</option>
                                            <option value="5">5to Semestre</option>
                                            <option value="6">6to Semestre</option>
                                            <option value="7">7mo Semestre</option>
                                            <option value="8">8vo Semestre</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="button-group">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Guardar Cambios
                                </button>
                                <button type="reset" class="btn btn-secondary">
                                    <i class="fas fa-redo"></i> Cancelar
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Quick Stats -->
                    <div class="profile-card">
                        <h3 style="margin-top: 0; color: var(--primary-color);">
                            <i class="fas fa-chart-bar"></i> Estad√≠sticas
                        </h3>

                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <div style="padding-bottom: 1rem; border-bottom: 1px solid var(--border-color);">
                                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0;">Perfil Completado</p>
                                <div style="background: var(--bg-lighter); border-radius: 0.5rem; height: 8px; margin-top: 0.5rem; overflow: hidden;">
                                    <div style="background: linear-gradient(90deg, var(--primary-color), var(--secondary-color)); height: 100%; width: 75%;"></div>
                                </div>
                                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0.5rem 0 0 0;">75%</p>
                            </div>

                            <div>
                                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0;">Miembro desde</p>
                                <p style="font-weight: 600; margin: 0.5rem 0 0 0;" id="member-since">Noviembre 2025</p>
                            </div>
                        </div>
                    </div>

                    <!-- CV Upload Card -->
                    <div class="profile-card cv-upload-card" id="cv-upload-card">
                        <h3 style="margin-top: 0; color: var(--primary-color);">
                            <i class="fas fa-file-pdf"></i>
                            Curr√≠culum Vitae
                        </h3>
                        <div class="cv-upload-area" id="cv-upload-area" onclick="console.log('Upload area clicked directly');">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p><strong>Arrastra tu CV aqu√≠ o haz clic para seleccionar</strong></p>
                            <p class="upload-hint">PDF o DOCX (m√°ximo 5MB)</p>
                        </div>
                        <input type="file" id="cv-file-input" accept=".pdf,.doc,.docx" style="display:none;">
                        <div id="cv-status" style="margin-top: 1rem;">
                        
                            <div class="cv-status-empty">
                                    <i class="fas fa-file-pdf"></i>
                                    <p>No hay CV cargado</p>
                                
                            </div>
                        
                        </div>
                        <div class="button-group">
                            <a id="cv-download-btn" class="btn btn-secondary" style="display:none;">
                                <i class="fas fa-download"></i> Descargar CV
                            </a>
                            <button id="cv-delete-btn" class="btn btn-secondary" style="display:none;">
                                <i class="fas fa-trash"></i> Eliminar CV
                            </button>
                        </div>

                        <div class="section-divider"></div>

                        <p style="font-size: 0.9rem; color: var(--text-secondary);">
                            <i class="fas fa-info-circle"></i>
                            Cuando subes tu CV, nuestro sistema utiliza Procesamiento de Lenguaje Natural (NLP) para analizar autom√°ticamente tus habilidades t√©cnicas y blandas.
                        </p>
                        
                            <!-- Help Card -->
                        <div class="profile-card">
                            <h3 style="margin-top: 0; color: var(--primary-color);">
                                <i class="fas fa-question-circle"></i> Ayuda
                            </h3>

                            <ul style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 0.75rem;">
                                <li><a href="#" style="color: var(--primary-color); text-decoration: none; font-weight: 500;">Centro de Ayuda</a></li>
                                <li><a href="#" style="color: var(--primary-color); text-decoration: none; font-weight: 500;">Contactar Soporte</a></li>
                                <li><a href="#" style="color: var(--primary-color); text-decoration: none; font-weight: 500;">Documentaci√≥n</a></li>
                            </ul>
                        </div>

                        <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 1rem;">
                            <i class="fas fa-info-circle"></i>
                            Cuando subes tu CV, nuestro sistema utiliza NLP para analizar autom√°ticamente tus habilidades.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2025 MoirAI. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Config -->
    <script>
        const protocol = window.location.protocol
        const hostname = window.location.hostname
        const port = window.location.port
        const origin = port ? `${protocol}//${hostname}:${port}` : `${protocol}//${hostname}`
        window.API_BASE_URL = `${origin}/api/v1`
        console.log('üîó API Base URL:', window.API_BASE_URL)
    </script>

    <!-- Scripts -->
    <script src="/static/js/api-client.js"></script>
    <script src="/static/js/utils/storage-manager.js"></script>
    <script src="/static/js/auth-manager.js"></script>
    <script src="/static/js/notification-manager.js"></script>
    <script src="/static/js/utils/form-validator.js"></script>
    <script src="/static/js/protected-page-manager.js"></script>
    <script src="/static/js/navbar-manager.js"></script>
    <script src="/static/js/pages/profile.js"></script>
</body>

</html>
