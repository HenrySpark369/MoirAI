<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - MoirAI</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/profile.css">
    <link rel="stylesheet" href="/static/css/notifications.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="/dashboard">
                    <i class="fas fa-brain"></i>
                    <span>MoirAI</span>
                </a>
            </div>

            <div class="nav-menu">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="/dashboard" class="nav-link">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/oportunidades" class="nav-link">
                            <i class="fas fa-briefcase"></i>
                            <span>Oportunidades</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/profile" class="nav-link active">
                            <i class="fas fa-user"></i>
                            <span>Mi Perfil</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="nav-cta">
                <button class="btn btn-secondary" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="profile-main">
        <!-- Profile Header -->
        <section class="profile-header">
            <h1><i class="fas fa-user-circle"></i> Mi Perfil</h1>
            <p>Administra tu información personal y habilidades</p>
        </section>

        <!-- Profile Container -->
        <div class="profile-container">
            <div class="profile-content">
                <!-- Main Content -->
                <div class="profile-main-content">
                    <!-- Profile Information Card -->
                    <div class="profile-card">
                        <h2>
                            <i class="fas fa-id-card"></i>
                            Información Personal
                        </h2>

                        <form id="profile-form" class="profile-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="first_name">
                                        Nombre <span class="required">*</span>
                                    </label>
                                    <input type="text" id="first_name" name="first_name" placeholder="Tu nombre" data-validate="text" required>
                                </div>
                                <div class="form-group">
                                    <label for="last_name">
                                        Apellido <span class="required">*</span>
                                    </label>
                                    <input type="text" id="last_name" name="last_name" placeholder="Tu apellido" data-validate="text" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="email">
                                    Correo Electrónico (no editable)
                                </label>
                                <input type="email" id="email" name="email" disabled>
                            </div>

                            <div class="form-group">
                                <label for="phone">Teléfono</label>
                                <input type="tel" id="phone" name="phone" placeholder="+56 9 1234 5678" data-validate="phone">
                            </div>

                            <div class="form-group">
                                <label for="bio">
                                    Biografía <span class="required">*</span>
                                </label>
                                <textarea id="bio" name="bio" placeholder="Cuéntanos sobre ti..." data-validate="textarea" required></textarea>
                            </div>

                            <!-- Student Fields -->
                            <div id="student-fields" style="display:none;">
                                <h3 style="margin-top: 0; color: var(--primary-color);">Información Académica</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="career">Carrera</label>
                                        <select id="career" name="career">
                                            <option value="">Selecciona tu carrera</option>
                                            <option value="ingenieria-sistemas">Ingeniería en Sistemas</option>
                                            <option value="ingenieria-electrica">Ingeniería Eléctrica</option>
                                            <option value="administracion">Administración</option>
                                            <option value="contabilidad">Contabilidad</option>
                                            <option value="marketing">Marketing</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="year">Año</label>
                                        <select id="year" name="year">
                                            <option value="">Selecciona tu año</option>
                                            <option value="1">1er Año</option>
                                            <option value="2">2do Año</option>
                                            <option value="3">3er Año</option>
                                            <option value="4">4to Año</option>
                                            <option value="5">5to Año o más</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="button-group">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Guardar Cambios
                                </button>
                                <button type="reset" class="btn btn-secondary">
                                    <i class="fas fa-redo"></i> Cancelar
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- CV Upload Card -->
                    <div class="profile-card">
                        <h2>
                            <i class="fas fa-file-pdf"></i>
                            Currículum Vitae
                        </h2>

                        <div class="cv-upload-area" id="cv-upload-area">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p><strong>Arrastra tu CV aquí o haz clic para seleccionar</strong></p>
                            <p class="upload-hint">PDF o DOCX (máximo 5MB)</p>
                        </div>
                        <input type="file" id="cv-file-input" accept=".pdf,.doc,.docx">

                        <div id="cv-status" style="margin-top: 1rem;">
                            <div class="cv-status-empty">
                                <i class="fas fa-file-pdf"></i>
                                <p>No hay CV cargado</p>
                            </div>
                        </div>

                        <div class="button-group">
                            <a id="cv-download-btn" class="btn btn-secondary" style="display:none;">
                                <i class="fas fa-download"></i> Descargar CV
                            </a>
                            <button id="cv-delete-btn" class="btn btn-secondary" style="display:none;">
                                <i class="fas fa-trash"></i> Eliminar CV
                            </button>
                        </div>

                        <div class="section-divider"></div>

                        <p style="font-size: 0.9rem; color: var(--text-secondary);">
                            <i class="fas fa-info-circle"></i>
                            Cuando subes tu CV, nuestro sistema utiliza Procesamiento de Lenguaje Natural (NLP) para analizar automáticamente tus habilidades técnicas y blandas.
                        </p>
                    </div>

                    <!-- Skills Card -->
                    <div class="profile-card">
                        <h2>
                            <i class="fas fa-brain"></i>
                            Habilidades Inferidas
                        </h2>

                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            Estas habilidades fueron identificadas automáticamente al procesar tu CV. Puedes remover cualquiera que no sea relevante.
                        </p>

                        <div id="inferred-skills">
                            <div class="empty-state">
                                <i class="fas fa-brain"></i>
                                <p>Sube tu CV para que analicemos tus habilidades</p>
                            </div>
                        </div>
                    </div>

                    <!-- Security Card -->
                    <div class="profile-card">
                        <h2>
                            <i class="fas fa-lock"></i>
                            Seguridad
                        </h2>

                        <button type="button" class="btn btn-secondary" onclick="handlePasswordChange()">
                            <i class="fas fa-key"></i> Cambiar Contraseña
                        </button>
                    </div>

                    <!-- Danger Zone -->
                    <div class="danger-zone">
                        <h3><i class="fas fa-exclamation-triangle"></i> Zona de Peligro</h3>
                        <p>Eliminar tu cuenta es permanente y no se puede deshacer.</p>
                        <button type="button" class="btn" style="background: #ef4444; color: white;">
                            <i class="fas fa-trash"></i> Eliminar Cuenta
                        </button>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="profile-sidebar">
                    <!-- User Summary Card -->
                    <div class="profile-card" style="text-align: center;">
                        <div style="width: 100px; height: 100px; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); border-radius: 50%; margin: 0 auto 1rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3 id="sidebar-name">Usuario</h3>
                        <p style="color: var(--text-secondary); margin: 0 0 1rem 0;" id="sidebar-role">Estudiante</p>

                        <button type="button" class="btn btn-primary" style="width: 100%; justify-content: center;">
                            <i class="fas fa-camera"></i> Cambiar Foto
                        </button>
                    </div>

                    <!-- Quick Stats -->
                    <div class="profile-card">
                        <h3 style="margin-top: 0; color: var(--primary-color);">
                            <i class="fas fa-chart-bar"></i> Estadísticas
                        </h3>

                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <div style="padding-bottom: 1rem; border-bottom: 1px solid var(--border-color);">
                                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0;">Perfil Completado</p>
                                <div style="background: var(--bg-lighter); border-radius: 0.5rem; height: 8px; margin-top: 0.5rem; overflow: hidden;">
                                    <div style="background: linear-gradient(90deg, var(--primary-color), var(--secondary-color)); height: 100%; width: 75%;"></div>
                                </div>
                                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0.5rem 0 0 0;">75%</p>
                            </div>

                            <div>
                                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0;">Miembro desde</p>
                                <p style="font-weight: 600; margin: 0.5rem 0 0 0;" id="member-since">Noviembre 2025</p>
                            </div>
                        </div>
                    </div>

                    <!-- Help Card -->
                    <div class="profile-card">
                        <h3 style="margin-top: 0; color: var(--primary-color);">
                            <i class="fas fa-question-circle"></i> Ayuda
                        </h3>

                        <ul style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 0.75rem;">
                            <li><a href="#" style="color: var(--primary-color); text-decoration: none; font-weight: 500;">Centro de Ayuda</a></li>
                            <li><a href="#" style="color: var(--primary-color); text-decoration: none; font-weight: 500;">Contactar Soporte</a></li>
                            <li><a href="#" style="color: var(--primary-color); text-decoration: none; font-weight: 500;">Documentación</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2025 MoirAI. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Config -->
    <script>
        window.API_BASE_URL = 'http://localhost:8000/api/v1'
    </script>

    <!-- Scripts -->
    <script src="/static/js/api-client.js"></script>
    <script src="/static/js/auth-manager.js"></script>
    <script src="/static/js/notification-manager.js"></script>
    <script src="/static/js/utils/form-validator.js"></script>
    <script src="/static/js/utils/storage-manager.js"></script>
    <script src="/static/js/navbar-manager.js"></script>
    <script src="/static/js/pages/profile.js"></script>
</body>

</html>
